{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/prabishdangi/Desktop/Personal/untitled%20folder%203/quotation-restorefine/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\n  })\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n\nexport default prisma\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/prabishdangi/Desktop/Personal/untitled%20folder%203/quotation-restorefine/src/lib/session.ts"],"sourcesContent":["import { randomBytes } from 'crypto'\nimport prisma from './prisma'\n\nconst SESSION_EXPIRY_DAYS = 30\n\n/**\n * Generate a cryptographically secure random session token\n * @returns 64-character hexadecimal token\n */\nexport function generateSessionToken(): string {\n  return randomBytes(32).toString('hex')\n}\n\n/**\n * Create a new session for a user\n * @param userId - User ID to create session for\n * @returns Created session object with token\n */\nexport async function createSession(userId: string) {\n  const token = generateSessionToken()\n  const expiresAt = new Date()\n  expiresAt.setDate(expiresAt.getDate() + SESSION_EXPIRY_DAYS)\n\n  const session = await prisma.session.create({\n    data: {\n      userId,\n      token,\n      expiresAt,\n    },\n    include: {\n      user: {\n        select: {\n          id: true,\n          email: true,\n          name: true,\n          createdAt: true,\n          updatedAt: true,\n        },\n      },\n    },\n  })\n\n  return session\n}\n\n/**\n * Validate a session token and return the session with user if valid\n * @param token - Session token to validate\n * @returns Session with user if valid, null otherwise\n */\nexport async function validateSession(token: string) {\n  const session = await prisma.session.findUnique({\n    where: { token },\n    include: {\n      user: {\n        select: {\n          id: true,\n          email: true,\n          name: true,\n          createdAt: true,\n          updatedAt: true,\n        },\n      },\n    },\n  })\n\n  if (!session) {\n    return null\n  }\n\n  // Check if session has expired\n  if (session.expiresAt < new Date()) {\n    // Delete expired session\n    await prisma.session.delete({\n      where: { id: session.id },\n    })\n    return null\n  }\n\n  return session\n}\n\n/**\n * Delete a session (for logout)\n * @param token - Session token to delete\n */\nexport async function deleteSession(token: string) {\n  await prisma.session.delete({\n    where: { token },\n  })\n}\n\n/**\n * Delete all sessions for a user (for password reset)\n * @param userId - User ID to delete all sessions for\n */\nexport async function deleteAllUserSessions(userId: string) {\n  await prisma.session.deleteMany({\n    where: { userId },\n  })\n}"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,sBAAsB;AAMrB,SAAS;IACd,OAAO,IAAA,oHAAW,EAAC,IAAI,QAAQ,CAAC;AAClC;AAOO,eAAe,cAAc,MAAc;IAChD,MAAM,QAAQ;IACd,MAAM,YAAY,IAAI;IACtB,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK;IAExC,MAAM,UAAU,MAAM,iIAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC1C,MAAM;YACJ;YACA;YACA;QACF;QACA,SAAS;YACP,MAAM;gBACJ,QAAQ;oBACN,IAAI;oBACJ,OAAO;oBACP,MAAM;oBACN,WAAW;oBACX,WAAW;gBACb;YACF;QACF;IACF;IAEA,OAAO;AACT;AAOO,eAAe,gBAAgB,KAAa;IACjD,MAAM,UAAU,MAAM,iIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC9C,OAAO;YAAE;QAAM;QACf,SAAS;YACP,MAAM;gBACJ,QAAQ;oBACN,IAAI;oBACJ,OAAO;oBACP,MAAM;oBACN,WAAW;oBACX,WAAW;gBACb;YACF;QACF;IACF;IAEA,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,+BAA+B;IAC/B,IAAI,QAAQ,SAAS,GAAG,IAAI,QAAQ;QAClC,yBAAyB;QACzB,MAAM,iIAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC1B,OAAO;gBAAE,IAAI,QAAQ,EAAE;YAAC;QAC1B;QACA,OAAO;IACT;IAEA,OAAO;AACT;AAMO,eAAe,cAAc,KAAa;IAC/C,MAAM,iIAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC1B,OAAO;YAAE;QAAM;IACjB;AACF;AAMO,eAAe,sBAAsB,MAAc;IACxD,MAAM,iIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC9B,OAAO;YAAE;QAAO;IAClB;AACF"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///Users/prabishdangi/Desktop/Personal/untitled%20folder%203/quotation-restorefine/src/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers'\nimport { validateSession } from './session'\n\nconst COOKIE_NAME = process.env.COOKIE_NAME || 'auth_session'\n\n/**\n * Get the authenticated user from the request\n * @returns User object if authenticated, null otherwise\n */\nexport async function getAuthUser() {\n  const cookieStore = await cookies()\n  const sessionToken = cookieStore.get(COOKIE_NAME)?.value\n\n  if (!sessionToken) {\n    return null\n  }\n\n  const session = await validateSession(sessionToken)\n\n  if (!session) {\n    return null\n  }\n\n  return session.user\n}\n\n/**\n * Set the session cookie\n * @param token - Session token to set in cookie\n */\nexport async function setSessionCookie(token: string) {\n  const cookieStore = await cookies()\n  const expiresAt = new Date()\n  expiresAt.setDate(expiresAt.getDate() + 30) // 30 days\n\n  cookieStore.set(COOKIE_NAME, token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    expires: expiresAt,\n    path: '/',\n  })\n}\n\n/**\n * Clear the session cookie (for logout)\n */\nexport async function clearSessionCookie() {\n  const cookieStore = await cookies()\n  cookieStore.delete(COOKIE_NAME)\n}"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAMxC,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,eAAe,YAAY,GAAG,CAAC,cAAc;IAEnD,IAAI,CAAC,cAAc;QACjB,OAAO;IACT;IAEA,MAAM,UAAU,MAAM,IAAA,0IAAe,EAAC;IAEtC,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,OAAO,QAAQ,IAAI;AACrB;AAMO,eAAe,iBAAiB,KAAa;IAClD,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,YAAY,IAAI;IACtB,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK,KAAI,UAAU;IAEtD,YAAY,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,SAAS;QACT,MAAM;IACR;AACF;AAKO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///Users/prabishdangi/Desktop/Personal/untitled%20folder%203/quotation-restorefine/src/app/api/quotes/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport prisma from '@/lib/prisma'\nimport { getAuthUser } from '@/lib/auth'\n\n// GET /api/quotes - Get all quotes for authenticated user\nexport async function GET(request: NextRequest) {\n  try {\n    const user = await getAuthUser()\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Not authenticated' },\n        { status: 401 }\n      )\n    }\n\n    const quotes = await prisma.quote.findMany({\n      where: { userId: user.id },\n      orderBy: { createdAt: 'desc' },\n    })\n\n    return NextResponse.json({ quotes })\n  } catch (error) {\n    console.error('Get quotes error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n\n// POST /api/quotes - Create a new quote\nexport async function POST(request: NextRequest) {\n  try {\n    const user = await getAuthUser()\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Not authenticated' },\n        { status: 401 }\n      )\n    }\n\n    const body = await request.json()\n\n    // Validate required fields\n    const requiredFields = [\n      'clientName',\n      'packageName',\n      'subtitle',\n      'platforms',\n      'addOns',\n      'price',\n      'ctaTitle',\n      'ctaText',\n      'ctaHighlight',\n      'ctaFooter',\n    ]\n\n    for (const field of requiredFields) {\n      if (body[field] === undefined || body[field] === null) {\n        return NextResponse.json(\n          { error: `Missing required field: ${field}` },\n          { status: 400 }\n        )\n      }\n    }\n\n    // Create quote\n    const quote = await prisma.quote.create({\n      data: {\n        userId: user.id,\n        clientName: body.clientName,\n        clientLogo: body.clientLogo || null,\n        packageName: body.packageName,\n        subtitle: body.subtitle,\n        videoCount: body.videoCount || 0,\n        photoCount: body.photoCount || 0,\n        showVideos: body.showVideos !== undefined ? body.showVideos : true,\n        showPhotos: body.showPhotos !== undefined ? body.showPhotos : true,\n        platforms: body.platforms,\n        addOns: body.addOns,\n        price: body.price,\n        ctaTitle: body.ctaTitle,\n        ctaText: body.ctaText,\n        ctaHighlight: body.ctaHighlight,\n        ctaHighlightColor: body.ctaHighlightColor || '#EF4444',\n        ctaHighlightUnderline:\n          body.ctaHighlightUnderline !== undefined\n            ? body.ctaHighlightUnderline\n            : true,\n        ctaFooter: body.ctaFooter,\n      },\n    })\n\n    return NextResponse.json(\n      { quote, message: 'Quote created successfully' },\n      { status: 201 }\n    )\n  } catch (error) {\n    console.error('Create quote error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,mIAAW;QAE9B,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,MAAM,iIAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;YACzC,OAAO;gBAAE,QAAQ,KAAK,EAAE;YAAC;YACzB,SAAS;gBAAE,WAAW;YAAO;QAC/B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAO;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,mIAAW;QAE9B,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,2BAA2B;QAC3B,MAAM,iBAAiB;YACrB;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QAED,KAAK,MAAM,SAAS,eAAgB;YAClC,IAAI,IAAI,CAAC,MAAM,KAAK,aAAa,IAAI,CAAC,MAAM,KAAK,MAAM;gBACrD,OAAO,gJAAY,CAAC,IAAI,CACtB;oBAAE,OAAO,CAAC,wBAAwB,EAAE,OAAO;gBAAC,GAC5C;oBAAE,QAAQ;gBAAI;YAElB;QACF;QAEA,eAAe;QACf,MAAM,QAAQ,MAAM,iIAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YACtC,MAAM;gBACJ,QAAQ,KAAK,EAAE;gBACf,YAAY,KAAK,UAAU;gBAC3B,YAAY,KAAK,UAAU,IAAI;gBAC/B,aAAa,KAAK,WAAW;gBAC7B,UAAU,KAAK,QAAQ;gBACvB,YAAY,KAAK,UAAU,IAAI;gBAC/B,YAAY,KAAK,UAAU,IAAI;gBAC/B,YAAY,KAAK,UAAU,KAAK,YAAY,KAAK,UAAU,GAAG;gBAC9D,YAAY,KAAK,UAAU,KAAK,YAAY,KAAK,UAAU,GAAG;gBAC9D,WAAW,KAAK,SAAS;gBACzB,QAAQ,KAAK,MAAM;gBACnB,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;gBACvB,SAAS,KAAK,OAAO;gBACrB,cAAc,KAAK,YAAY;gBAC/B,mBAAmB,KAAK,iBAAiB,IAAI;gBAC7C,uBACE,KAAK,qBAAqB,KAAK,YAC3B,KAAK,qBAAqB,GAC1B;gBACN,WAAW,KAAK,SAAS;YAC3B;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE;YAAO,SAAS;QAA6B,GAC/C;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}